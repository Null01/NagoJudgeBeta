<ui:composition 
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:p="http://primefaces.org/ui"
    xmlns:fn="http://java.sun.com/jsp/jstl/core"
    template="template/begins.xhtml">

    <ui:define name="content">

        <div class="well">
            <h:form id="form-submit-sourcecode" class="form-horizontal" enctype="multipart/form-data">
                <p:messages id="msgs" autoUpdate="true" closable="true"/>
                <fieldset>
                    <div class="form-group">
                        <label for="select-problem" class="col-md-1 control-label">Problema</label>
                        <div class="col-md-2">
                            <p:selectOneMenu id="select-problem"
                                             styleClass="selected-list form-control"
                                             style="width: 100%;"
                                             converter="pairConvertJSF"
                                             value="#{roomSubmitBean.pairMessageView}"
                                             required="true" >
                                <f:selectItem value="#{null}" itemLabel="Seleccione un problema" />
                                <f:selectItems value="#{roomSubmitBean.listProblemItems}" />                                               
                            </p:selectOneMenu>
                        </div>
                        <label for="select-language" class="col-md-1 control-label">Lenguaje</label>
                        <div class="col-md-2">
                            <p:selectOneMenu id="select-language"
                                             styleClass="selected-list form-control"
                                             style="width: 100%;"
                                             converter="languageProgrammingConvertJSF"
                                             value="#{roomSubmitBean.languageProgrammingMessage}"
                                             required="true" >
                                <f:selectItem value="#{null}" itemLabel="Seleccione un lenguaje" />
                                <f:selectItems value="#{roomSubmitBean.listLanguageProgrammingItems}" />                                               
                            </p:selectOneMenu>
                        </div>
                        <label for="upload-sourceCode" class="col-md-2 control-label">Codigo fuente</label>
                        <div class="col-md-4">
                            <p:fileUpload id="upload-sourceCode"
                                          styleClass="form-control center-block"
                                          value="#{roomSubmitBean.fileSourceCode}"
                                          mode="simple"
                                          skinSimple="true"
                                          required="true"
                                          allowTypes="/(\.|\/)(java|cpp|c)$/"
                                          label="#{msg['general.label.archivo.upload']}" />
                        </div>
                    </div>
                    <div class="form-group text-center">
                        <p:commandButton styleClass="btn btn-default btn-sm center-block text-center"
                                         value="Enviar soluciÃ³n"
                                         ajax="false"
                                         action="#{roomSubmitBean.actionSubmitSourceCode}"
                                         update="msgs, @form"/>
                    </div>
                </fieldset>
            </h:form>
        </div>

        <div class="well">
            <fieldset>
                <div class="form-group">
                    <p:dataTable id="table-problems-client"
                                 widgetVar="widgetSubmitsClient"
                                 tableStyleClass="table table-striped table-hover"
                                 value="#{roomSubmitBean.listSubmits}"
                                 var="s"
                                 rowStyleClass="#{s.idStatus eq 'AC'?
                                                  'success': (s.idStatus eq 'WR'?
                                                  'danger': (s.idStatus eq 'TL'?
                                                  'info': (s.idStatus eq 'RE'?
                                                  'warning': (s.idStatus eq 'CE'?
                                                  'ce': null)))) }"
                                 styleClass="center-block text-bold"
                                 rowKey="#{s.idSubmit}"
                                 rowIndexVar="indexKey"
                                 paginator="false"
                                 paginatorPosition="bottom"                                     
                                 emptyMessage="#{msg['general.table.noinfo']}">
                        <p:column headerText="#" width="5%" styleClass="text-center" >
                            #{roomSubmitBean.listSubmits.size() - indexKey} 
                        </p:column>
                        <p:column headerText="Id" width="3%" styleClass="text-center" >
                            <h:outputText value="#{roomSubmitBean.mapLettersGlobs[s.problemMessage.idProblem]}" />
                        </p:column>
                        <p:column headerText="Id Envio" width="8%" styleClass="text-center" >
                            <h:outputText value="#{s.idSubmit}" />
                        </p:column>
                        <p:column headerText="Problema" width="20%" styleClass="text-left" >
                            <h:outputText value="#{s.problemMessage.nameProblem}" />
                        </p:column>
                        <p:column headerText="Lenguaje" width="8%" styleClass="text-center" >
                            <h:outputText value="#{s.languageProgrammingMessage.nameProgramming}" />
                        </p:column>
                        <p:column headerText="Tiempo" width="8%" styleClass="text-center" >
                            <h:outputText value="#{s.timeUsed}" >
                                <f:convertDateTime pattern="s.SSS" />
                            </h:outputText>
                        </p:column>
                        <p:column headerText="Fecha Envio" width="15%" styleClass="text-center" >
                            <h:outputText value="#{s.dateSubmit}" >
                                <f:convertDateTime pattern="dd MMM yyyy - HH:mm:ss" timeZone=""  />
                            </h:outputText>
                        </p:column>
                        <p:column headerText="Estado" width="20%" styleClass="text-center" >
                            <h:outputText id="tooltipEstado" value="#{s.nameStatus}" />
                            <p:tooltip for="tooltipEstado" value="#{s.descriptionStatus}" position="left"/>
                        </p:column>
                        <p:column width="8%" styleClass="text-center" >
                            <ui:fragment rendered="#{s.idStatus eq 'AC'}" >
                                <img src="#{roomSubmitBean.mapColorsGlogs[s.problemMessage.idProblem]}" class="globe-center"  />
                            </ui:fragment>
                            <ui:fragment rendered="#{s.idStatus ne 'AC'}" >
                                <h:outputText value="-/-" styleClass="text-center" />
                            </ui:fragment>
                        </p:column>
                    </p:dataTable>

                </div>
            </fieldset> 
        </div>
    </ui:define>
</ui:composition>

